-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public."mUnlocked"
(
    m_id integer NOT NULL,
    us_id integer NOT NULL,
    CONSTRAINT "mUnlocked_pkey" PRIMARY KEY (m_id, us_id)
);

CREATE TABLE IF NOT EXISTS public.messages
(
    m_id integer NOT NULL DEFAULT nextval('messages_id_seq'::regclass),
    m_type text COLLATE pg_catalog."default",
    creator character varying(100) COLLATE pg_catalog."default",
    unl_rad integer NOT NULL DEFAULT 30,
    geom geometry(Point,4326) NOT NULL,
    crt_time integer,
    uni_id integer COLLATE pg_catalog."default",
    view_once boolean,
    status boolean,
    m_txt text COLLATE pg_catalog."default",
    q_multi integer,
    CONSTRAINT messages_pkey PRIMARY KEY (m_id)
);

CREATE TABLE IF NOT EXISTS public."possAnsw"
(
    q_id integer NOT NULL,
    aswr_id integer NOT NULL,
    aswr_txt text COLLATE pg_catalog."default" NOT NULL,
    tf boolean NOT NULL,
    CONSTRAINT "possAnsw_pkey" PRIMARY KEY (q_id, answr_id)
);

CREATE TABLE IF NOT EXISTS public.question
(
    q_id integer NOT NULL,
    q_txt text COLLATE pg_catalog."default"
);

CREATE TABLE IF NOT EXISTS public.universe
(
    uni_id integer NOT NULL DEFAULT nextval('"universe_universalID_seq"'::regclass),
    uni_name character varying(150) COLLATE pg_catalog."default" NOT NULL,
    pub_priv boolean NOT NULL,
    descri text COLLATE pg_catalog."default",
    CONSTRAINT universe_pkey PRIMARY KEY (uni_id)
);

CREATE TABLE IF NOT EXISTS public.user_answ_que
(
    q_id integer,
    aswr_id integer,
    us_id integer,
    PRIMARY KEY (q_id, aswr_id, us_id)
);

CREATE TABLE IF NOT EXISTS public.users
(
    us_id integer NOT NULL,
    us_name text NOT NULL DEFAULT nextval('users_user_name_seq'::regclass),
    pwd text COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT users_pkey PRIMARY KEY (us_id)
);

CREATE TABLE IF NOT EXISTS public.users_universe
(
    users_us_id integer NOT NULL,
    universe_uni_id integer NOT NULL DEFAULT nextval('"universe_universalID_seq"'::regclass)
);

CREATE TABLE IF NOT EXISTS public.users_messages
(
    users_us_id integer NOT NULL,
    messages_m_id integer NOT NULL DEFAULT nextval('messages_id_seq'::regclass)
);

ALTER TABLE IF EXISTS public.messages
    ADD CONSTRAINT creator FOREIGN KEY (creator)
    REFERENCES public.users (us_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.messages
    ADD CONSTRAINT uni FOREIGN KEY (uni)
    REFERENCES public.universe (uni_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.messages
    ADD CONSTRAINT q_multi FOREIGN KEY (q_multi)
    REFERENCES public.question (q_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.user_answ_que
    ADD FOREIGN KEY (q_id)
    REFERENCES public.question (q_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.user_answ_que
    ADD FOREIGN KEY (aswr_id)
    REFERENCES public."possAnsw" (aswr_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.user_answ_que
    ADD FOREIGN KEY (us_id)
    REFERENCES public.users (us_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users_universe
    ADD FOREIGN KEY (users_us_id)
    REFERENCES public.users (us_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users_universe
    ADD FOREIGN KEY (universe_uni_id)
    REFERENCES public.universe (uni_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users_messages
    ADD FOREIGN KEY (users_us_id)
    REFERENCES public.users (us_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users_messages
    ADD FOREIGN KEY (messages_m_id)
    REFERENCES public.messages (m_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;

BEGIN;

-- Create example Users Data

INSERT INTO public.users (us_id, us_name, pwd) VALUES
(1001, 'marietranova', 'pw_marie'),
(1002, 'bekirbeko', 'pw_beko'),
(1003, 'wilmadora', 'pw_wilma'),
(1004, 'jacobvanmeer', 'pw_jacob'),
(1005, 'lindaelfriede', 'pw_linda');


-- Create example Universe Data

INSERT INTO public.universe (uni_id, uni_name, pub_priv, descri) VALUES
(2001,'LisboaFunfacts',true,'Funfacts about the city of Lisbon.'),
(2002,'GeoTech252627',false,'Universe for all GeoTech students.'),
(2003,'RestaurantReviewsLisbon',true,'Users reviews of restaurants in Lisbon.'),
(2004,'SunsetViewpoints',true,'Best viewpoints to watch the sunset in Lisbon.'),
(2005,'Erasmus2026summer',false,'Erasmus student network for the summer semester of 2026.'),
(2006,'Swifties',true,'Universe for all Taylor Swift fans worldwide.'),
(2007,'LisbonRepair',true,'Real-time sharing of information about locations in Lisbon that need construction or maintenance work.'),
(2008,'LostAndFound',true,'Universe for sharing information about lost and found items in Lisbon.'),
(2009,'LisbonEvents',true,'Universe for sharing information about events happening in Lisbon.'); 

-- Create example Users_Universes Data

INSERT INTO public.users_universe (users_us_id, universe_uni_id) VALUES
(1001,2001),(1001,2002), (1001,2007), (1001,2009),
(1002,2002),(1002,2005), (1002,2006), (1002,2009),
(1003,2002),(1003,2004), (1003,2008), (1003,2009),
(1004,2004),(1004,2005), (1004,2009),
(1005,2002),(1005,2003), (1005,2007), (1005,2009); 

-- Create example question Data

INSERT INTO public.question (q_id, q_txt, uni_id) VALUES
(3001,'Would you recommend this viewpoint?', 2004),
(3002,'Why does the Convento do Carmo no longer have a roof today?', 2001),
(3003,'Hey GeoTechs, this saturday I want to celebrate my birthday with you!! Meet me here in this parc around 8:30 PM. I will provide some snacks and drinks and hope we will have a great time together! See you there xx', 2002),
(3004,'Unfortunately the elevator is broken o my friend with a wheelchair could not pass. Please make sure to repair it as soon as possible. Thank you!', 2007),
(3005,'I found some sunglasses on a park bench here. They are brown with a leopard pattern. Email me here when you think they might be yours: wilma.foundyourglasses@web.de', 2008),
(3006,'Rooftop Party here this weekend! Rua Leonardo 14, 3rd floor, 5â‚¬ at the entrance including a welcome drink.', 2009),
(3007,'Congratulations Swiftie!! You are the first person to get the special message I left in this Hotel for you. Your individual discount code for my next tour is "swiftielisboa224519". You will get a 20 percent discount on your next concert tickets and a personal meet-and-greet after the show. See you then!! xxTaylor', 2006);    

-- Create example possAnsw Data 


INSERT INTO public."possAnsw" (q_id, aswr_id, aswr_txt, tf) VALUES

--Question 3001 possible answers
(3001,4001,'Yes',true),
(3001,4002, 'No',false),

--Question 3002 possible answers
(3002,4003,'Because of the earthquake in 1755',true),
(3002,4004,'Because of a fire in 1900',false),
(3002,4005,'Because of a flood in 1800',false),

--Question 3003 possible answers
(3003,4006,'I will be there!!',true),
(3003,4007,'Sorry, I can not make it this time.',false),

--Question 3004 possible answers
(3004,4008,'I have received your report and will report it to the city council immediately!',true),

--Question 3005 possible answers
--do we need an answer here?

--Question 3006 possible answers
(3006,4009,'I will be there!!',true),
(3006,4010,'Sorry, I can not make it this time.',false);

--Question 3007 possible answers
-- no answer needed for this question, it is more of an announcement than a question, but we could add a "Thank you for the discount code, I will use it for my next concert tickets!" answer option if we want to be consistent with the other questions.

--Create example messages_users Data

INSERT INTO public.users_messages (users_us_id, messages_m_id) VALUES
(1001,5001),(1001,5002),(1001,5003),
(1002,5004),(1002,5005),(1002,5006),
(1003,5007),(1003,5008),(1003,5009),
(1004,5010),(1004,5011),(1004,5012),
(1005,5013),(1005,5014),(1005,5015);


