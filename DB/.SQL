-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public."mUnlocked"
(
    m_id integer NOT NULL,
    us_id integer NOT NULL,
    CONSTRAINT "mUnlocked_pkey" PRIMARY KEY (m_id, us_id)
);

CREATE TABLE IF NOT EXISTS public.messages
(
    m_id integer NOT NULL DEFAULT nextval('messages_id_seq'::regclass),
    m_type text COLLATE pg_catalog."default",
    creator character varying(100) COLLATE pg_catalog."default",
    unl_rad integer NOT NULL DEFAULT 30,
    geom geometry(Point,4326) NOT NULL,
    crt_time integer,
    uni_id integer COLLATE pg_catalog."default",
    view_once boolean,
    status boolean,
    m_txt text COLLATE pg_catalog."default",
    q_multi integer,
    CONSTRAINT messages_pkey PRIMARY KEY (m_id)
);

CREATE TABLE IF NOT EXISTS public."possAnsw"
(
    q_id integer NOT NULL,
    aswr_id integer NOT NULL,
    aswr_txt text COLLATE pg_catalog."default" NOT NULL,
    tf boolean NOT NULL,
    CONSTRAINT "possAnsw_pkey" PRIMARY KEY (q_id)
);

CREATE TABLE IF NOT EXISTS public.question
(
    q_id integer NOT NULL,
    q_txt text COLLATE pg_catalog."default"
);

CREATE TABLE IF NOT EXISTS public.universe
(
    uni_id integer NOT NULL DEFAULT nextval('"universe_universalID_seq"'::regclass),
    uni_name character varying(150) COLLATE pg_catalog."default" NOT NULL,
    pub_priv boolean NOT NULL,
    descri text COLLATE pg_catalog."default",
    CONSTRAINT universe_pkey PRIMARY KEY (uni_id)
);

CREATE TABLE IF NOT EXISTS public.user_answ_que
(
    q_id integer,
    aswr_id integer,
    us_id integer,
    PRIMARY KEY (q_id, aswr_id, us_id)
);

CREATE TABLE IF NOT EXISTS public.users
(
    us_id integer NOT NULL,
    us_name integer NOT NULL DEFAULT nextval('users_user_name_seq'::regclass),
    pwd text COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT users_pkey PRIMARY KEY (us_id)
);

CREATE TABLE IF NOT EXISTS public.users_universe
(
    users_us_id integer NOT NULL,
    universe_uni_id integer NOT NULL DEFAULT nextval('"universe_universalID_seq"'::regclass)
);

CREATE TABLE IF NOT EXISTS public.users_messages
(
    users_us_id integer NOT NULL,
    messages_m_id integer NOT NULL DEFAULT nextval('messages_id_seq'::regclass)
);

ALTER TABLE IF EXISTS public.messages
    ADD CONSTRAINT creator FOREIGN KEY (creator)
    REFERENCES public.users (us_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.messages
    ADD CONSTRAINT uni FOREIGN KEY (uni)
    REFERENCES public.universe (uni_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.messages
    ADD CONSTRAINT q_multi FOREIGN KEY (q_multi)
    REFERENCES public.question (q_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.user_answ_que
    ADD FOREIGN KEY (q_id)
    REFERENCES public.question (q_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.user_answ_que
    ADD FOREIGN KEY (aswr_id)
    REFERENCES public."possAnsw" (aswr_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.user_answ_que
    ADD FOREIGN KEY (us_id)
    REFERENCES public.users (us_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users_universe
    ADD FOREIGN KEY (users_us_id)
    REFERENCES public.users (us_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users_universe
    ADD FOREIGN KEY (universe_uni_id)
    REFERENCES public.universe (uni_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users_messages
    ADD FOREIGN KEY (users_us_id)
    REFERENCES public.users (us_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.users_messages
    ADD FOREIGN KEY (messages_m_id)
    REFERENCES public.messages (m_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;

BEGIN;

-- Create example Users Data

INSERT INTO public.users (us_id, us_name, pwd) VALUES
(1001, marietranova, 'pw_marie'),
(1002, bekirbeko, 'pw_beko'),
(1003, wilmadora, 'pw_wilma'),
(1004, jacobvanmeer, 'pw_jacob'),
(5, lindaelfriede, 'pw_linda');


-- Create example Universe Data

INSERT INTO public.universe (uni_id, uni_name, pub_priv, descri) VALUES
(2001,'LisboaFunfacts',true,'Funfacts about the city of Lisbon.'),
(2002,'GeoTech252627',false,'Universe for all GeoTech students.'),
(2003,'RestaurantReviewsLisbon',true,'Users reviews of restaurants in Lisbon.'),
(2004,'SunsetViewpoints',true,'Best viewpoints to watch the sunset in Lisbon.'),
(2005,'Erasmus2026summer',false,'Erasmus student network for the summer semester of 2026.'),
(2006,'Swifties',true,'Universe for all Taylor Swift fans worldwide.'),
(2007,'LisbonRepair',true,'Real-time sharing of information about locations in Lisbon that need construction or maintenance work.'),
(2008,'LostAndFound',true,'Universe for sharing information about lost and found items in Lisbon.'),
(2009,'LisbonEvents',true,'Universe for sharing information about events happening in Lisbon.'); 

-- Create example Users_Universes Data

INSERT INTO public.users_universe (users_us_id, universe_uni_id) VALUES
(1001,2001),(1001,2002), (1001,2007), (1001,2009),
(1002,2002),(1002,2005), (1002,2006), (1002,2009),
(1003,2002),(1003,2004), (1003,2008), (1003,2009),
(1004,2004),(1004,2005), (1004,2009),
(1005,2002),(1005,2003), (1005,2007), (1005,2009); 

-- Create example question Data

INSERT INTO public.question (q_id, q_txt, uni_id) VALUES
(1001,'What is the best viewpoint to watch the sunset in Lisbon?', 2004),
(1002,'What is your favorite fun fact about Lisbon?', 2001),
(1003,'Which restaurant in Lisbon would you recommend?', 2003),
(1004,'What is your favorite Taylor Swift song?', 2006),
(1005,'Which event in Lisbon are you most looking forward to?', 2009);

