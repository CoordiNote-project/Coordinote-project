<title>CoordiNote  </title>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoordiNote</title>
<!-- Google Fonts, text type plus loaded font weights, headings, logo text, big titles, highlighted UI elements -->

  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500&display=swap" rel="stylesheet" />
  <!-- Leaflet (the map library) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <link rel="stylesheet" href="style.css" />
</head>

<script>
function showMain() {
  document.getElementById("loginScreen").style.display = "none";
  document.getElementById("mainScreen").style.display = "block";
}
</script>

<body>
<div id="app">

  <!-- building the Sidebar -->
<!-- NEW SIDEBAR WITH TWO VIEWS -->
<aside class="sidebar" id="sidebar">

  <!-- â•â•â• SIDEBAR HEADER (always visible) â•â•â• -->
  <div class="sidebar-header">
    <div class="sidebar-logo">
      <div class="logo-icon">ğŸ“</div>
      <span class="logo-text">Coordi<em>Note</em></span>
    </div>
  </div>

  <!-- â•â•â• VIEW TOGGLE TABS â•â•â• -->
  <div class="view-tabs">
    <button class="view-tab active" id="tabReceiver" onclick="switchView('receiver')">
      <span class="tab-icon">ğŸ“¥</span>
      <span class="tab-label">Receive</span>
    </button>
    <button class="view-tab" id="tabSender" onclick="switchView('sender')">
      <span class="tab-icon">ğŸ“¤</span>
      <span class="tab-label">Send</span>
    </button>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       ğŸ“¥ RECEIVER VIEW (default visible)
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="sidebar-view active" id="viewReceiver">
    
    <!-- Search & Create Universes -->
    <div class="action-row">
      <input type="text" id="searchUniverse" class="search-input-small" 
             placeholder="ğŸ” Search universes..." oninput="searchUniverses(this.value)"/>
      <button class="btn-icon-small" id="btnCreateUniverse" 
              onclick="openCreateUniverseModal()" title="Create Universe">
        â•
      </button>
    </div>

    <!-- Universe List -->
    <div class="section-title">My Universes</div>
    <div class="universe-list-new" id="universeListReceiver">
      <!-- Filled by JavaScript -->
      <div class="uni-skeleton"></div>
      <div class="uni-skeleton"></div>
      <div class="uni-skeleton"></div>
    </div>

     <!-- Delete Universe - leave Universe -->
   <button class="btn-icon-small danger"
          id="btnDeleteUniverse"
          onclick="deleteSelectedUniverse()"
          title="Delete Universe">
    ğŸ—‘ï¸
  </button>

  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       ğŸ“¤ SENDER VIEW (hidden by default)
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="sidebar-view" id="viewSender">
    
    <div class="section-title">Create New Message</div>

    <!-- Message Type -->
    <div class="form-group-compact">
      <label class="field-label-small">Type</label>
      <div class="type-pills">
        <button class="type-pill active" onclick="setSenderMsgType('text', this)">
          ğŸ’¬ Text
        </button>
        <button class="type-pill" onclick="setSenderMsgType('yesno', this)">
          âœ… Yes/No
        </button>
        <button class="type-pill" onclick="setSenderMsgType('poll', this)">
          ğŸ“Š Poll
        </button>
      </div>
    </div>

    <!-- Universe Selection -->
    <div class="form-group-compact">
      <label class="field-label-small">Universe</label>
      <select id="senderUniverseSelect" class="field-input-compact">
        <!-- Filled by JS -->
      </select>
    </div>

    <!-- Message Content -->
    <div class="form-group-compact" id="senderTextGroup">
      <label class="field-label-small">Message</label>
      <textarea id="senderTextContent" class="field-input-compact field-ta-compact" 
                rows="3" placeholder="Write your message..."></textarea>
    </div>

    <div class="form-group-compact hidden" id="senderQuestionGroup">
      <label class="field-label-small">Question</label>
      <input type="text" id="senderQuestionContent" class="field-input-compact"
             placeholder="Enter your question..."/>
    </div>

    <!-- Location Selection -->
    <div class="section-title" style="margin-top:16px">ğŸ“ Location</div>
    
    <div class="location-options">
      <button class="location-btn active" id="btnDropPin" onclick="setLocationMode('pin')">
        <span>ğŸ“Œ</span>
        <span>Drop Pin</span>
      </button>
      <button class="location-btn" id="btnSearchLocation" onclick="setLocationMode('search')">
        <span>ğŸ”</span>
        <span>Search</span>
      </button>
    </div>

    <!-- Location Search (hidden by default) -->
    <div class="location-search hidden" id="locationSearchBox">
      <input type="text" id="locationSearchInput" class="search-input-small"
             placeholder="Search location..." onkeyup="searchLocation(event)"/>
      <div id="locationResults" class="location-results"></div>
    </div>

    <!-- Selected Location Display -->
    <div class="location-display" id="senderLocationDisplay">
      <div class="location-icon">ğŸ–±ï¸</div>
      <div class="location-text">Click on map to set location</div>
    </div>

    <!-- Unlock Radius -->
    <div class="form-group-compact">
      <label class="field-label-small">
        Unlock Radius: <strong id="senderRadiusLabel">50m</strong>
      </label>
      <input type="range" id="senderRadiusSlider" min="10" max="500" value="50" 
             class="slider" oninput="updateSenderRadius(this.value)"/>
    </div>

    <!-- Submit Button -->
    <button class="btn-submit-sidebar" onclick="submitMessageFromSidebar()">
      Drop Message ğŸ“
    </button>

  </div>

  <!-- â•â•â• USER ROW (always at bottom) â•â•â• -->
  <div class="user-row">
    <div class="avatar" id="userAvatar">WK</div>
    <div class="user-info">
      <div class="user-name" id="userName">wilmakahl</div>
      <div class="user-sub">Logged in</div>
    </div>
    <button class="icon-btn" id="logoutBtn" title="Logout">â†©</button>
  </div>

</aside>

  <!-- map -->
  <div class="map-wrap">
    <div id="map"></div>

    <!-- Top controls -->
    <div class="map-toolbar">
      <button class="tool-btn active" id="btnMessages" title="Show Messages">âœ‰ï¸</button>
      <button class="tool-btn" id="btnPOIs" title="Show POIs">ğŸ—ºï¸</button>
      <button class="tool-btn" id="btnLocate" title="My Location">ğŸ“</button>
      <button class="tool-btn" id="btnRefresh" title="Refresh">ğŸ”„</button>
    </div>

  <!-- SIDE PANEL (message detail)-->
  <div class="side-panel" id="sidePanel">
    <div class="panel-header">
      <button class="back-btn" id="closePanelBtn">â† Back</button>
      <span class="panel-badge" id="panelBadge">TEXT</span>
    </div>
    <div class="panel-body" id="panelBody">
      <!-- filled by JS -->
    </div>
  </div>

  <!-- MODAL â€“ Create Message -->
  <div class="modal-backdrop hidden" id="createModal">
    <div class="modal">
      <div class="modal-header">
        <h2>ğŸ“ New Message</h2>
        <button class="modal-close" id="closeModalBtn">âœ•</button>
      </div>

      <!-- Type tabs -->
      <div class="type-tabs">
        <button class="type-tab active" data-type="text">
          <span>ğŸ’¬</span> Text
        </button>
        <button class="type-tab" data-type="yesno">
          <span>â“</span> Yes / No
        </button>
        <button class="type-tab" data-type="poll">
          <span>ğŸ“Š</span> Poll
        </button>
      </div>

      <!-- Form -->
      <div class="modal-form">

        <!-- Universe -->
        <label class="field-label">Universe</label>
        <select id="modalUniverse" class="field-input"></select>

        <!-- Text content (text only) -->
        <div id="textSection">
          <label class="field-label">Message</label>
          <textarea id="modalText" class="field-input field-ta" rows="4"
            placeholder="Write your messageâ€¦"></textarea>
        </div>

        <!-- Question (yesno / poll) -->
        <div id="questionSection" class="hidden">
          <label class="field-label">Question</label>
          <input type="text" id="modalQuestion" class="field-input"
            placeholder="Enter your questionâ€¦" />
        </div>

        <!-- Radius -->
        <label class="field-label">
          Unlock Radius â€” <strong id="radiusDisplay">50 m</strong>
        </label>
        <input type="range" id="radiusSlider" min="10" max="500"
          value="50" class="slider" />

        <!-- Location confirmation -->
        <div class="location-chip" id="locationChip">
          ğŸ–±ï¸ Click on the map to set location first
        </div>

      </div>

      <div class="modal-footer">
        <button class="btn-cancel" id="cancelModalBtn">Cancel</button>
        <button class="btn-submit" id="submitMessageBtn">Drop Message ğŸ“</button>
      </div>
    </div>
  </div>

  </div> <!-- end of app -->

<!-- MODAL â€“ Login -->
<div class="modal-backdrop" id="loginModal">
  <div class="modal modal-sm">
    <div class="modal-header">
      <div class="login-logo">
        <div class="logo-icon">ğŸ“</div>
        <span class="logo-text">Coordi<em>Note</em></span>
      </div>
    </div>
    <div class="modal-form">
      <label class="field-label">Username</label>
      <input type="text" id="loginUser" class="field-input" placeholder="e.g. wilmakahl" />
      
      <label class="field-label" style="margin-top:12px">Password</label>
      <input type="password" id="loginPass" class="field-input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
      
      <!-- Confirm Password (hidden by default) -->
      <div id="confirmPasswordField" class="hidden">
        <label class="field-label" style="margin-top:12px">Confirm Password</label>
        <input type="password" id="loginPassConfirm" class="field-input" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
      </div>
      
      <div class="login-error hidden" id="loginError">âŒ Wrong credentials</div>
    </div>
    <div class="modal-footer" style="flex-direction:column;gap:8px;">
      <button class="btn-submit" id="loginBtn">Login</button>
      <button class="btn-cancel" id="registerBtn">Register new account</button>
    </div>
  </div>
</div>

  <!-- Toast notification -->
  <div class="toast hidden" id="toast"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="app.js"></script>
</body>

</html>
